<template>
  <div class="menu">
    <el-scrollbar style="height:100%"  :class="menuscroll==false?'myscroll':''" ref="scrolls">
      <div class="menu_item">
          <div class="menu_title">个人信息</div>
          <div class="user_info">
            <img src="../static/img/headpic.jpg" alt="">
            <div class="name">淡然</div>
            <div class="icon_list">
              <a class="pic" href="https://github.com/gkmdanran" target="_blank">
                <svg t="1605068279723" class="icon" viewBox="0 0 1049 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9360" width="100%" height="100%"><path d="M524.979332 0C234.676191 0 0 234.676191 0 524.979332c0 232.068678 150.366597 428.501342 358.967656 498.035028 26.075132 5.215026 35.636014-11.299224 35.636014-25.205961 0-12.168395-0.869171-53.888607-0.869171-97.347161-146.020741 31.290159-176.441729-62.580318-176.441729-62.580318-23.467619-60.841976-58.234462-76.487055-58.234463-76.487055-47.804409-32.15933 3.476684-32.15933 3.476685-32.15933 53.019436 3.476684 80.83291 53.888607 80.83291 53.888607 46.935238 79.963739 122.553122 57.365291 152.97411 43.458554 4.345855-33.897672 18.252593-57.365291 33.028501-70.402857-116.468925-12.168395-239.022047-57.365291-239.022047-259.012982 0-57.365291 20.860106-104.300529 53.888607-140.805715-5.215026-13.037566-23.467619-66.926173 5.215027-139.067372 0 0 44.327725-13.906737 144.282399 53.888607 41.720212-11.299224 86.917108-17.383422 131.244833-17.383422s89.524621 6.084198 131.244833 17.383422C756.178839 203.386032 800.506564 217.29277 800.506564 217.29277c28.682646 72.1412 10.430053 126.029806 5.215026 139.067372 33.897672 36.505185 53.888607 83.440424 53.888607 140.805715 0 201.64769-122.553122 245.975415-239.891218 259.012982 19.121764 16.514251 35.636014 47.804409 35.636015 97.347161 0 70.402857-0.869171 126.898978-0.869172 144.282399 0 13.906737 9.560882 30.420988 35.636015 25.205961 208.601059-69.533686 358.967656-265.96635 358.967655-498.035028C1049.958663 234.676191 814.413301 0 524.979332 0z" fill="#191717" p-id="9361"></path><path d="M199.040177 753.571326c-0.869171 2.607513-5.215026 3.476684-8.691711 1.738342s-6.084198-5.215026-4.345855-7.82254c0.869171-2.607513 5.215026-3.476684 8.691711-1.738342s5.215026 5.215026 4.345855 7.82254z m-6.953369-4.345856M219.900283 777.038945c-2.607513 2.607513-7.82254 0.869171-10.430053-2.607514-3.476684-3.476684-4.345855-8.691711-1.738342-11.299224 2.607513-2.607513 6.953369-0.869171 10.430053 2.607514 3.476684 4.345855 4.345855 9.560882 1.738342 11.299224z m-5.215026-5.215027M240.760389 807.459932c-3.476684 2.607513-8.691711 0-11.299224-4.345855-3.476684-4.345855-3.476684-10.430053 0-12.168395 3.476684-2.607513 8.691711 0 11.299224 4.345855 3.476684 4.345855 3.476684 9.560882 0 12.168395z m0 0M269.443034 837.011749c-2.607513 3.476684-8.691711 2.607513-13.906737-1.738342-4.345855-4.345855-6.084198-10.430053-2.607513-13.037566 2.607513-3.476684 8.691711-2.607513 13.906737 1.738342 4.345855 3.476684 5.215026 9.560882 2.607513 13.037566z m0 0M308.555733 853.526c-0.869171 4.345855-6.953369 6.084198-13.037566 4.345855-6.084198-1.738342-9.560882-6.953369-8.691711-10.430053 0.869171-4.345855 6.953369-6.084198 13.037566-4.345855 6.084198 1.738342 9.560882 6.084198 8.691711 10.430053z m0 0M351.145116 857.002684c0 4.345855-5.215026 7.82254-11.299224 7.82254-6.084198 0-11.299224-3.476684-11.299224-7.82254s5.215026-7.82254 11.299224-7.82254c6.084198 0 11.299224 3.476684 11.299224 7.82254z m0 0M391.126986 850.049315c0.869171 4.345855-3.476684 8.691711-9.560882 9.560882-6.084198 0.869171-11.299224-1.738342-12.168395-6.084197-0.869171-4.345855 3.476684-8.691711 9.560881-9.560882 6.084198-0.869171 11.299224 1.738342 12.168396 6.084197z m0 0" fill="#191717" p-id="9362">
                  </path>
                </svg>
              </a>
              <el-popover
                placement="bottom"
                :close-delay="0"
                transition=""
                width="200"
                trigger="hover"
                >
                <div class="hi">交个朋友吧~(づ｡◕ᴗᴗ◕｡)づ</div>
                <img src="../static/img/wx.png" alt="" class="erweima">
                <div class="number">微信号：g1755989501</div>
                <div class="remark">(加我记得备注 淡然-博客~)</div>
                <el-button slot="reference" plain>
                  <div class="pic">
                    <svg t="1605065249316" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4333" width="100%" height="100%"><path d="M512 1005.037037C238.933333 1005.037037 18.962963 785.066667 18.962963 512S238.933333 18.962963 512 18.962963s493.037037 219.97037 493.037037 493.037037-219.97037 493.037037-493.037037 493.037037z m-89.125926-739.555556C305.303704 265.481481 208.592593 348.918519 208.592593 455.111111c0 60.681481 32.237037 109.985185 85.333333 149.807408l-20.859259 66.37037 75.851852-37.925926c24.651852 5.688889 49.303704 9.481481 75.851851 11.377778 7.585185 0 13.274074 0 20.85926-1.896297-3.792593-15.17037-5.688889-30.340741-7.585186-47.407407 0-98.607407 81.540741-176.355556 178.251852-176.355556H639.051852c-17.066667-87.22963-109.985185-153.6-216.177778-153.6z m210.488889 166.874075c-102.4 0-182.044444 72.059259-182.044444 161.185185s79.644444 161.185185 182.044444 161.185185c20.859259-1.896296 43.614815-5.688889 64.474074-11.377778l58.785185 34.133333-17.066666-54.992592c43.614815-34.133333 75.851852-79.644444 75.851851-128.948148 0-89.125926-85.333333-161.185185-182.044444-161.185185z m60.681481 136.533333c-13.274074 0-24.651852-9.481481-24.651851-22.755556s9.481481-24.651852 22.755555-24.651852 24.651852 9.481481 24.651852 22.755556v1.896296c0 11.377778-9.481481 20.859259-22.755556 22.755556z m-117.57037 0c-13.274074 0-24.651852-9.481481-24.651852-22.755556s9.481481-24.651852 22.755556-24.651852 24.651852 9.481481 24.651852 22.755556v1.896296c0 11.377778-9.481481 20.859259-22.755556 22.755556z m-75.851852-149.807408c-15.17037 0-30.340741-11.377778-30.340741-28.444444 0-15.17037 11.377778-30.340741 28.444445-30.340741 15.17037 0 30.340741 11.377778 30.340741 28.444445v1.896296c0 15.17037-11.377778 28.444444-28.444445 28.444444z m-147.911111 0c-15.17037 0-30.340741-11.377778-30.340741-28.444444 0-15.17037 11.377778-30.340741 28.444445-30.340741 15.17037 0 30.340741 11.377778 30.340741 28.444445v1.896296c0 15.17037-13.274074 28.444444-28.444445 28.444444z" fill="#49b543" p-id="4334">
                      </path>
                    </svg>
                </div>
                </el-button>
              </el-popover>
              <el-popover
                placement="bottom"
                width="200"
                transition=""
                :close-delay="0"
                trigger="hover"
                >
                <div class="hi">很高兴认识你~(*￣︶￣)</div>
                <img src="../static/img/qq.png" alt="" class="erweima">
                <div class="number">QQ：1755989501</div>
                <div class="remark">(加我记得备注 淡然-博客~)</div>
                <el-button slot="reference" plain>
                  <div class="pic">
                    <svg t="1605068142048" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8442" width="100%" height="100%"><path d="M510.634667 954.026667a319.402667 319.402667 0 0 1-209.92-72.789334 267.093333 267.093333 0 0 0-77.653334 36.352c-17.066667 13.824-15.104 27.648-12.288 32.768 13.653333 24.746667 235.349333 15.957333 299.178667 7.936l0.682667-4.266666z m0 0a319.402667 319.402667 0 0 0 210.005333-72.789334c27.477333 7.765333 53.674667 20.053333 77.653333 36.352 17.066667 13.824 15.018667 27.648 12.288 32.768-13.653333 24.746667-235.434667 15.957333-299.264 7.936l-0.682666-4.266666z" fill="#F0A817" p-id="8443"></path><path d="M510.634667 448.170667a1162.666667 1162.666667 0 0 0 286.890666-36.352 35.669333 35.669333 0 0 0 13.738667-6.826667V371.2C811.946667 185.258667 724.821333 0 510.634667 0c-214.186667 0-301.226667 185.344-301.226667 369.92v33.621333a25.429333 25.429333 0 0 0 11.605333 8.277334c94.72 24.234667 192 36.437333 289.621334 36.352z m376.149333 153.770666c-8.277333-27.477333-20.565333-59.733333-32.256-90.624a34.986667 34.986667 0 0 0-10.24 0c-108.458667 31.573333-220.672 48.128-333.653333 49.493334A1244.330667 1244.330667 0 0 1 179.2 512a48.042667 48.042667 0 0 0-12.373333 0c-11.690667 30.890667-23.381333 63.146667-32.256 90.624-41.216 131.754667-27.477333 186.026667-17.92 187.306667 22.016 0 84.48-98.816 84.48-98.816a286.890667 286.890667 0 0 0 309.504 262.229333 286.890667 286.890667 0 0 0 306.858666-262.826667s62.378667 101.546667 84.394667 98.730667c10.24 0 23.296-55.552-17.92-187.306667h2.816z" fill="#040000" p-id="8444"></path><path d="M434.517333 274.517333c-28.842667 0-54.272-31.573333-55.637333-74.069333-1.365333-42.666667 20.565333-77.653333 49.493333-78.933333 28.757333-1.365333 53.418667 31.573333 55.466667 74.069333 2.133333 42.581333-20.48 78.933333-49.322667 78.933333m207.957334-75.52c-1.450667 41.898667-26.794667 75.52-55.637334 75.52s-51.456-36.352-49.408-78.933333c2.048-42.496 26.112-75.434667 55.552-74.069333 29.525333 1.365333 51.541333 36.352 49.493334 78.933333" fill="#FFFFFF" p-id="8445"></path><path d="M693.930667 332.202667a307.456 307.456 0 0 0-183.296-36.352 307.456 307.456 0 0 0-182.613334 36.352 5.461333 5.461333 0 0 0 0 5.461333 337.066667 337.066667 0 0 0 182.613334 57.002667 337.066667 337.066667 0 0 0 182.613333-57.002667" fill="#F0A817" p-id="8446"></path><path d="M470.186667 210.517333c2.645333 20.906667-6.229333 41.386667-20.650667 47.104-12.288 0-23.978667-14.762667-25.344-39.253333-2.56-19.541333 4.864-38.912 17.834667-46.08 12.373333 0 24.064 14.677333 25.429333 39.253333m82.346667 8.789334c12.117333-26.453333 35.157333-38.058667 56.32-28.416a25.429333 25.429333 0 0 1 15.018666 9.813333 17.578667 17.578667 0 0 1 0 12.714667c-1.877333 5.973333-6.741333 8.533333-10.837333 5.973333l-0.085333-0.085333c-16.384-15.445333-38.314667-10.837333-50.858667 10.752-1.962667 2.304-4.864 2.304-6.826667 0a14.677333 14.677333 0 0 1 0-12.714667" fill="#040000" p-id="8447"></path><path d="M510.634667 554.581333a1151.658667 1151.658667 0 0 1-226.474667-23.381333 634.88 634.88 0 0 0-7.509333 146.176c8.874667 146.261333 96.768 239.530667 233.984 240.981333 137.301333 0 222.378667-94.037333 231.253333-240.981333a636.245333 636.245333 0 0 0-7.509333-146.176c-73.642667 15.104-148.48 22.869333-223.744 23.381333" fill="#FFFFFF" p-id="8448"></path><path d="M321.194667 542.208v144.128c43.946667 7.936 88.832 9.386667 133.12 4.096V558.08a1221.717333 1221.717333 0 0 1-133.12-15.786667" fill="#DB2528" p-id="8449"></path><path d="M811.264 403.626667a1126.997333 1126.997333 0 0 1-300.629333 41.813333 1126.997333 1126.997333 0 0 1-299.861334-41.813333l-43.264 107.690666c111.36 33.28 226.901333 50.858667 343.125334 52.138667a1246.378667 1246.378667 0 0 0 343.210666-52.138667l-42.581333-107.776z" fill="#DB2528" p-id="8450">
                      </path>
                    </svg>
                </div>
                </el-button>
              </el-popover>
              
            </div>
            <div class="tips">越是漫长，越要淡然。</div>
          </div>
      </div>
      <div class="menu_item" style="marginTop:'5px">
          <div class="menu_title">搜索</div>
          <div class="search">
           
            <el-autocomplete
              class="inline-input"
              v-model="query"
              :fetch-suggestions="querySearch"
              placeholder="请输入标题"
              clearable
              :trigger-on-focus="false"
              @select="handleSelect"
            ></el-autocomplete>
            <a class="baidu" href="http://www.baidu.com" target="_blank">
              <span class="bdtxt">搜索更多?百度一下 </span>
              <svg t="1605078427785"  class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1775" width="20" height="20">
                <path d="M176.73984 539.3792c113.8816-23.90784 98.39104-156.90752 94.97088-186.0352-5.60128-44.8128-59.53536-123.16928-132.76928-116.95872-92.19328 8.06144-105.66144 138.18112-105.66144 138.18112C20.78976 434.77504 63.13984 563.32544 176.73984 539.3792L176.73984 539.3792zM297.66656 770.74176c-3.32032 9.37984-10.75456 33.32608-4.32128 54.1312 12.70784 46.69696 58.39104 39.08352 58.39104 39.08352l64.01536 0 0-128.03328-64.01536 0C323.05408 744.30464 300.7744 761.43104 297.66656 770.74176L297.66656 770.74176zM388.15488 316.31104c62.92992 0 113.76128-70.77376 113.76128-158.18496 0-87.39072-50.8288-158.12608-113.76128-158.12608-62.80704 0-113.78688 70.73536-113.78688 158.12608C274.368 245.53728 325.3504 316.31104 388.15488 316.31104L388.15488 316.31104zM659.07968 326.77632c84.12416 10.65728 138.1504-77.00992 148.90752-143.45984 10.94144-66.35776-43.30752-143.46496-102.85056-156.71552-59.6608-13.38368-134.11072 80.02304-140.89728 140.86656C556.14208 241.88672 575.18336 316.21376 659.07968 326.77632L659.07968 326.77632zM865.12384 717.4784c0 0-130.08128-98.39104-206.0672-204.68992-102.94272-156.71552-249.19296-92.95872-298.07616-13.25824-48.68096 79.70304-124.608 130.08384-135.3984 143.46752-10.91328 13.12768-157.09696 90.2656-124.672 231.13472 32.42496 140.86656 154.80064 149.86752 154.80064 149.86752s75.63008-3.61984 173.09952-24.93952c97.46432-21.12 181.45792 5.25824 181.45792 5.25824s227.71456 74.5088 290.02752-68.95616C962.52928 791.86944 865.12384 717.4784 865.12384 717.4784L865.12384 717.4784zM479.76704 927.97184l-160.04864 0c-63.91808-1.50272-81.74848-52.08576-84.94848-59.34336-3.1744-7.3984-21.25824-41.67424-11.68128-99.93728 27.62496-87.3856 96.6656-96.76032 96.6656-96.76032l96.02816 0 0-96.0256 64.01792 0 0 352.06144L479.76704 927.97184 479.76704 927.97184zM735.84384 927.97184 575.7952 927.97184c-63.02464-2.69568-64.11776-60.4672-64.11776-60.4672l0.09984-195.60448 64.01792 0 0 160.0512c4.224 17.64096 32.00768 32.00512 32.00768 32.00512l64.02048 0 0-192.05376 64.02048 0L735.84384 927.97184 735.84384 927.97184zM992.39168 438.35904c0-31.77728-27.04896-127.51872-127.26784-127.51872-100.43904 0-113.85856 90.36032-113.85856 154.24768 0 60.94592 5.248 146.02496 130.01984 143.36768C1006.0544 605.80608 992.39168 470.34112 992.39168 438.35904L992.39168 438.35904z" fill="#2319dc" p-id="1776">
                </path>
              </svg>
            </a>
          </div>
      </div>
      <div class="menu_item" >
          <div class="menu_title">日历</div>
          <div class="calendar">
              <client-only><Calendar></Calendar></client-only>
            
          </div>
      </div>
      
      <div class="menu_item" >
          <div class="menu_title">最新博客</div>
          <div class="new_article">
            <div class="article" @click="toDetail(item._id)" v-for="(item,index) in newArticleList" :key="item._id">
              {{index+1}}、{{item.title}}
            </div>
          </div>
      </div>
      <div class="menu_item" >
          <div class="menu_title">我的标签</div>
          <div class="new_article">
            <div @click="$router.push({ name: 'tag-id',params:{id:item._id}})"
            class="article" v-for="item in tagList" :key="item._id" v-show="item.blogsStrs!=''">
              {{item.tagName}} ({{item.blogsStrs==''?0:item.blogsStrs.split(',').length}})
            </div>
          </div>
      </div>
    </el-scrollbar>
  </div>
  
</template>

<script>
import {request} from '~/plugins/axios'
export default {
  props:['menuscroll'],
  data(){
    return {
      query:'',
      newArticleList:[],
      tagList:[]
    }
  },
  methods:{
    async querySearch(queryString, cb) {
      var results=[{}]
      let res=await request({
        url:`/searcharticles?query=${queryString}`
      })
      console.log(res)
      if(res&&res.code==200){
        for(let x of res.data){
          results.push({value:x.title,...x})
        }
      }
      cb(results);
    },
    handleSelect(item) {
      this.$router.push({ name: "article-id",
					params:{
  						id:item._id
					}
      })
      this.query=''
    },
    
    toDetail(id){
      this.$router.push({ name: "article-id",
					params:{
  						id,
					}
			})
    },
  },
  async created(){
    Promise.all([
      request({url:`/newarticles`}),
      request({url:`/mytags`})
      ]).then(res => {
        // console.log(res)
      if(res[0]&&res[0].code==200)
        this.newArticleList=res[0].data
      if(res[1]&&res[1].code==200)
        this.tagList=res[1].data
    }, err => {
      console.log(err)
    })
  },
  watch: {
  menuscroll: {
    immediate: true, // 很重要！！！
    handler (val) {
    if(val==false){
      if(this.$refs.scrolls)
        this.$refs.scrolls.wrap.scrollTop=0
    }
   }
  }
 },
  
}
</script>

<style scoped>
  .menu{
    height: 100%;
    width: 100%;
    
  }
  .menu_item{
      margin-top: 20px;
      padding-right: 15px;
  }
  .menu_title{
      height: 20px;
      line-height: 20px;
      border-left: 4px solid #7396a7;
      color: #959fa5;
      padding-left: 5px;
      font-size: 14px;
      font-weight: 700;
  }
  .user_info{
    padding-top: 15px;
    padding-bottom: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .user_info img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
  }
  .user_info .name {
    margin-top: 10px;
    color: #8a959c;
    font-size: 14px;
    font-weight: 700;
  }
  .icon_list {
    margin-top: 10px;
    padding: 0 30px;
    width: 100%;
    display: flex;
    justify-content: space-evenly;
  }
  .icon_list .pic {
    display: inline-block;
    width: 30px;
    height: 30px;
    cursor: pointer;
  }
  .icon_list .el-button{
    width: 30px;
    height: 30px;
    background-color: transparent!important;
    border: none!important;
    padding: 0!important;
  }
  .hi{
    text-align: center;
    font-size: 13px;
    color: #969696;
    font-weight: 700;
  }
  .erweima{
    width: 100px;
    height: 100px;
    margin: 15px 38px 2px;
  }
  .number{
    text-align: center;
    font-size: 13px;
    color: #7f8c93;
  }
  .remark{
    margin-top: 5px;
    text-align: center;
    font-size: 13px;
    color: #7f8c93;
  }
  .tips{
    font-size: 14px;
    color: #7f8c93;
    margin-top: 5px;
    text-align: center;
  }
  .calendar{
    min-height: 150px;
  }
  .search{
    padding: 10px;
  }
  .search .el-input__inner{
    opacity: 0.6!important;
  }
  .baidu{
    cursor: pointer;
    width: 100%;
    color: #2319dc;
    font-size: 14px;
    font-weight: 700;
    text-align: center;
    display: flex;
    justify-content: center;
    margin-top: 15px;
  }
  .bdtxt{
    margin-right: 5px;
  }
  .new_article{
    padding: 10px;
  }
  .article{
    color: #2daebf;
    font-size: 14px;
    margin-bottom: 5px;
    text-overflow: -o-ellipsis-lastline;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    cursor: pointer;
    word-break: break-all;
  }
  .article:hover{
    color: #ff6600;
    transform: translateX(5px);
  }
</style>
<style >
  .menu .wh_content_all{
    background-color: transparent!important;
  }
  .menu .wh_top_tag,
  .menu .wh_item_date{
    color: #2daebf;
  }
  .menu .wh_content_li{
    font-weight: 700;
    color: #7f8c93!important;
    font-size: 16px!important;
  }
  .menu .wh_jiantou1,
  .menu .wh_jiantou2{
    border-color: #7f8c93!important;
  }
  .menu .wh_isToday{
    color: #ff6600!important;
    font-weight: 700;
    background: transparent!important;
  }
  .menu .wh_chose_day{
     color: green!important;
    font-weight: 700;
    background: transparent!important;
  }
  .menu .wh_item_date:hover{
    background: transparent!important;
  }
  .menu .el-scrollbar__wrap{
    overflow-x: hidden!important;
    
  }
  .menu .myscroll .el-scrollbar__wrap{
    overflow-x: hidden!important;
    overflow-y: hidden!important;
    
  }
  .menu .myscroll .menu_item {
    padding-right: 32px;
  }
  .menu .myscroll .el-scrollbar__thumb{
    opacity: 0!important;
  }
  .menu .el-autocomplete{
    width: 100%;
  }
  .el-autocomplete-suggestion.el-popper{
    min-height: 50px!important;
  }
</style>

